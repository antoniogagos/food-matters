<dom-module id="fm-app">
  <template>

    <style>

      :host {
      }

      fm-welcome-animation {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        z-index: 1;
      }


      paper-toolbar {
        --paper-toolbar-background: #F6F4E7;
        --paper-toolbar-color: #414141;

        --paper-toolbar: {
          background-image: url('../images/bg.png');
        }
      }

    </style>

    <fm-welcome-animation
      id="fmWelcome"
      on-initial-animation-finished="_onFmWelcomeAnimationFinished">
    </fm-welcome-animation>

    <paper-toolbar>
      <div class="title">{{currentMonth}}</div>
    </paper-toolbar>

    <div id="plants">
      <template is="dom-repeat" items="{{_plants}}">
        <template is="dom-if" if="{{_computePlantIf(item)}}">
          <div class="plant">{{item.name}}</div>
        </template>
      </template>
    </div>

  </template>
</dom-module>

<script>

  Polymer({

    is: "fm-app",

    properties: {

      currentMonth: {
        type: String,
        value: function() {
          var d = new Date();
          var month = d.getMonth();
          var months = ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'];
          return months[month];
        }
      },

      _plants: {
        type: Array,
        value: function() {
          return new Polymer.IronMeta({type: 'fm-data'}).byKey('plants');
        }
      }

    },

    _onFmWelcomeAnimationFinished: function() {
      setTimeout(function() {
        this.$.fmWelcome.disappear(function() {
          this.$.fmWelcome.remove();
        }.bind(this));
      }.bind(this), 1500);
    },

    _computePlantIf: function(item) {
      var d = new Date();
      var currentMonth = d.getMonth();
      return item.months.indexOf(currentMonth) > -1;
    }

  });

</script>
